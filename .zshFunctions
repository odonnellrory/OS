# cd to World of Warcraft AddOns (classic era default)
wowcd() {
  emulate -L zsh -o errexit -o nounset -o pipefail

  local wowbase="$HOME/Omni/Ludi/drive_c/Program Files (x86)/World of Warcraft"
  local flavor="${1:-}"

  case "${flavor:l}" in
    retail|r|_retail_)
      flavor="_retail_"
      ;;
    classic|era|_classic_era_|c|e)
      flavor="_classic_era_"
      ;;
    "")
      print "Choose WoW flavor:"
      print "  1) Classic Era (default)"
      print "  2) Retail"
      read "?Enter number [default 1]: " choice
      case "${choice:-1}" in
        1|"") flavor="_classic_era_";;
        2) flavor="_retail_";;
        *)
          print "Invalid choice; defaulting to Classic Era."
          flavor="_classic_era_"
          ;;
      esac
      ;;
    *)
      print -u2 -- "Unknown flavor: ${1}. Use 'retail' or 'classic'."
      return 2
      ;;
  esac

  local target="${wowbase}/${flavor}/Interface/AddOns"
  if [[ -d "$target" ]]; then
    cd -- "$target"
    print -- "â†’ ${PWD}"
  else
    print -u2 -- "Missing directory: $target"
    return 1
  fi
}

# Open (or create) a journal entry in Neovim.
# Usage: journal [YYYY-MM-DD|yesterday|tomorrow]
odonnellrorynew() {
  local repo="$HOME/Omni/Basilica/odonnellrory.github.io"
  local dir="$repo/docs/00-journal"
  local date_str file

  if [[ -n "${1:-}" ]]; then
    case "$1" in
      yesterday) date_str="$(date -d 'yesterday' +%F)" ;;
      tomorrow)  date_str="$(date -d 'tomorrow'  +%F)" ;;
      # YYYY-MM-DD
      [0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]) date_str="$1" ;;
      *)
        print -u2 "journal: pass YYYY-MM-DD, 'yesterday', or 'tomorrow'"
        return 2
        ;;
    esac
  else
    date_str="$(date +%F)"
  fi

  mkdir -p -- "$dir"
  file="$dir/$date_str.md"

  # Create a simple header if it's a new file
  if [[ ! -e "$file" ]]; then
    {
      printf '# %s\n\n' "$(date -d "$date_str" +%Y/%m/%d)"
    } > "$file"
  fi

  cd -- "$repo" || return
  nvim -- "$file"
}




#Rust Book guessing game
guessing_game() {
  cd ~/Projects/Rust/guessing_game/ && cargo run
}

#reloads zsh shell, essentially the same as typing "source ~/.zshrc"
sz() {
  local  messages=(
    "You suck!"
    "I hate you!"
    "You fucking did it!"
    "Well done, dick head!"
    "Nice one, pal."
    "Alright."
    "Yeah."
    "..."
    "I think it worked?"
    "Something like that."
    "Having fun?"
    "Reload me harder."
    )
  source ~/.zshrc
  echo "$messages[RANDOM % ${#messages[@]} + 1]"
}

# info - combines man and tldr to give you double the info on a command

info() {
  man "$1" && tldr "$1"  
}

# lfcd - lf is a terminal based file manager installed on the device, this script allows you to quickly navigate to a location in the terminal by visually seeing the directories.
# why did I describe lf to myself you fucking weirdo

lfcd() {
    tmp="$(mktemp)"
    lf -last-dir-path="$tmp" "$@"
    if [ -f "$tmp" ]; then
        dir="$(cat "$tmp")"
        rm -f "$tmp"
        [ -d "$dir" ] && [ "$dir" != "$(pwd)" ] && cd "$dir"
    fi
}
bindkey -s '^o' 'lfcd\n'



#bandit - innit

bandit() {
  local level="bandit$1"
  local pwfile=~/.overTheWirePasswords.txt
  local password=$(grep "^$level:" "$pwfile" | cut -d':' -f2)

  if [ -z "$password" ]; then
    echo "No Password"
    return 1
  fi

  sshpass -p "$password" ssh "$level@bandit.labs.overthewire.org" -p 2220
}


#search aliases

searchAliases() {
  cat ~/.aliases | grep $1
}



#change desktop environment

switchde() {
  local de="$1"
  local dm=""
  local session=""

  case "$de" in
    gnome)
      dm="gdm"
      session="gnome-session"
      ;;
    kde)
      dm="sddm"
      session="kde"
      ;;
    xfce)
      dm="lightdm"
      session="xfce"
      ;;
    *)
      echo "That ain't gnome or xfce, is it, tit head?"
      return 1
      ;;
  esac

  echo "Switching to $de using $dm..."

  # Disable all known DMs except the target one
  for other_dm in gdm lightdm; do
    if [[ "$other_dm" != "$dm" ]]; then
      sudo systemctl disable "$other_dm.service" >/dev/null 2>&1
    fi
  done

  sudo systemctl enable "$dm.service"

  # Set up session if using ~/.xsession
  echo "exec $session" > ~/.xsession

  echo "Desktop environment set to $de. Rebooting..."
  systemctl reboot
}



#  if [[ "$de" == "xfce" ]]; then
#    sudo systemctl disable gdm.service
#    sudo systemctl enable lightdm.service
#    sudo systemctl reboot
#  elif [[ "$de" == "gnome" ]]; then
#    sudo systemctl disable lightdm.service
#    sudo systemctl enable gdm.service
#    sudo systemctl reboot
#  else
#    echo "switchde xfce|gnome"
#  fi


#like lfcd but for yazi
function y() {
	local tmp="$(mktemp -t "yazi-cwd.XXXXXX")" cwd
	yazi "$@" --cwd-file="$tmp"
	IFS= read -r -d '' cwd < "$tmp"
	[ -n "$cwd" ] && [ "$cwd" != "$PWD" ] && builtin cd -- "$cwd"
	rm -f -- "$tmp"
  exec zsh
}
